# Holonic Book Review — Data Model

This document defines the **book** and **review** holon shapes and how they map to OASIS APIs. Use it as the single reference when implementing save/load and when building a simulator.

**Canonical brief:** [`Docs/holons/DECENTRALIZED_BOOK_REVIEW_HOLON_BRIEF.md`](../Docs/holons/DECENTRALIZED_BOOK_REVIEW_HOLON_BRIEF.md) §4.

---

## Conventions

- **Book / edition** = one **parent** holon. Its `id` is the parent id for all its reviews.
- **Review** = one **child** holon with `parentHolonId` = that book’s holon id.
- **Aggregation** = “all reviews for this book” = `load-holons-for-parent(bookHolonId)`.

No change to generic OASIS holon APIs: use existing `save-holon` and `load-holons-for-parent`. The “book review platform” is a **convention** (parent = book, children = reviews) on top of generic holons.

---

## 1. Book holon (parent)

One holon per book (or per edition if you split hardback/ebook).

| Field | Usage |
|-------|--------|
| `id` | Generated by OASIS. This is the **parent id** for all reviews of this book. |
| `name` | Book title (e.g. *“The Green Glass Sea”*) or “Title by Author”. |
| `description` | Short blurb or summary. |
| `holonType` | e.g. `"Holon"` or a custom type if your API supports it. |
| `metaData` | Optional key/value. Recommended keys: |

**Recommended `metaData` for book:**

| Key | Example | Notes |
|-----|---------|--------|
| `author` | `"Jane Doe"` | Author name. |
| `publisher` | `"Red Hen Press"` | Publisher name (use names from brief §3). |
| `isbn` | `"978-0-123456-78-9"` | Optional; use plausible mock if no real ISBN. |
| `coverUrl` | `"https://..."` | Optional cover image URL. |
| `genre` | `"Literary fiction"` | Optional. |

**Example (conceptual):**

```json
{
  "name": "The Green Glass Sea",
  "description": "A novel of family and wonder set in 1943.",
  "holonType": "Holon",
  "metaData": {
    "author": "Ellen Klages",
    "publisher": "Small Beer Press",
    "isbn": "978-1-931520-22-5",
    "coverUrl": "https://example.com/covers/green-glass-sea.jpg",
    "genre": "Speculative fiction"
  }
}
```

*(Id is assigned by OASIS on save.)*

---

## 2. Review holon (child)

One holon per review. Each has `parentHolonId` = the book’s holon id.

| Field | Usage |
|-------|--------|
| `parentHolonId` | **Required.** The book holon’s `id`. |
| `name` | Short label, e.g. `"Review by Jane Reader"` or `"Review from City Books"`. |
| `description` | Full review text. |
| `holonType` | e.g. `"Holon"`. |
| `metaData` | Optional. Recommended keys: |

**Recommended `metaData` for review:**

| Key | Example | Notes |
|-----|---------|--------|
| `rating` | `4` or `4.5` | Numeric rating (e.g. 1–5). |
| `reviewerName` | `"Jane Reader"` | Display name of reviewer. |
| `source` | `"Publisher website"` | Where the review came from. Use to show decentralization. |
| `date` | `"2026-01-15T12:00:00Z"` | When the review was submitted (ISO 8601). |

**Suggested `source` values (from brief):**

- `"Publisher site"` / `"Publisher website"`
- `"Independent bookshop"` / `"Bookshop"`
- `"Festival"` / `"Event"`
- `"Reader"` (direct from reader)
- `"Partner site"`

**Example (conceptual):**

```json
{
  "parentHolonId": "<bookHolonId>",
  "name": "Review by Jane Reader",
  "description": "A moving and clever novel. The period detail feels just right.",
  "holonType": "Holon",
  "metaData": {
    "rating": 5,
    "reviewerName": "Jane Reader",
    "source": "Publisher website",
    "date": "2026-01-15T14:30:00Z"
  }
}
```

---

## 3. OASIS API usage

Use the same endpoints as in the Shared Holon Playground and holonic-demo:

### Save holon (create or update)

```
POST /api/data/save-holon
Content-Type: application/json

{
  "name": "...",
  "description": "...",
  "holonType": "Holon",
  "metaData": { ... }
}
```

For a **review**, include `"parentHolonId": "<bookHolonId>"` in the body.

Response typically includes the saved holon with `id` (and possibly `parentHolonId` echo). Use that `id` when loading or when attaching further children.

### Load one holon

```
GET /api/data/load-holon/{holonId}?loadChildren=false&recursive=false
```

Use for loading a single **book** holon by id. For “all reviews for this book” use load-holons-for-parent instead.

### Load holons for parent (aggregate reviews)

```
GET /api/data/load-holons-for-parent/{parentId}/All?loadChildren=false&recursive=false
```

- `parentId` = the **book** holon’s `id`.
- Returns a list of **child** holons (the reviews).
- From that list you can:  
  - Render each review (name, description, metaData.rating, metaData.reviewerName, metaData.source, metaData.date).  
  - Compute aggregate rating (e.g. average of `metaData.rating`).  
  - Count by `metaData.source`.

Existing holonic-demo client pattern (from `holonic-demo/oasis-api.js`):

```js
async loadHolonsForParent(parentId, holonType = 'All', loadChildren = true, recursive = true) {
  return this.request(`/api/data/load-holons-for-parent/${parentId}/${holonType}?loadChildren=${loadChildren}&recursive=${recursive}`);
}
```

---

## 4. Simulator (when API is unavailable)

If the demo runs without a live OASIS API, implement a **simulator** that keeps the same structure:

- **In memory or localStorage:**  
  - Store “books” as objects with `id`, `name`, `description`, `metaData`.  
  - Store “reviews” as objects with `parentHolonId`, `name`, `description`, `metaData`.
- **Simulated save-holon:**  
  - If body has `parentHolonId`, treat as review: generate id, append to reviews list.  
  - Else treat as book: generate id, append to books list.
- **Simulated load-holon(id):**  
  - Return holon from books or reviews by `id`.
- **Simulated load-holons-for-parent(parentId):**  
  - Return all reviews where `parentHolonId === parentId`.

Keep the same field names and shapes so that switching to the real API only requires swapping the client implementation, not the data model.

---

## 5. Example publishers and sample data (from brief §3)

Use these real independent presses in sample data and UI copy:

| Publisher | Use in demo as |
|-----------|-----------------|
| **Small Beer Press** (Easthampton, MA) | Speculative/literary; “small press” example |
| **Red Hen Press** | “Biggest little indie”; poetry/literary |
| **Rescue Press** | Poetry, prose, hybrid; independent literary |
| **Dzanc Books** | Literary fiction since 2006; award‑winning small press |
| **Sarabande Books** (Louisville, KY) | Poetry/short fiction/essays; 30‑year indie |

Create **2–3 sample books** attributed to these publishers, and **several reviews per book** with different `metaData.source` values so the “one aggregated view from many sources” story is clear.
